<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="420" viewBox="0 0 1200 420" xmlns="http://www.w3.org/2000/svg" 
     xmlns:xlink="http://www.w3.org/1999/xlink" role="img" aria-label="Two stage pipeline architecture diagram">
  <style>
    .blk { fill:#ffffff; stroke:#0b3d91; stroke-width:2; rx:8; ry:8; }
    .reg { fill:#f0f6ff; stroke:#0b3d91; stroke-width:1.6; rx:4; ry:4; }
    .text { font-family: "Helvetica Neue", Arial, sans-serif; fill:#0b3d91; font-weight:700; }
    .sub { font-family: "Helvetica Neue", Arial, sans-serif; fill:#222; font-size:13px; }
    .arrow { stroke:#0b3d91; stroke-width:2; fill:none; marker-end: url(#arrowhead); }
    .sig { font-family: "Helvetica Neue", Arial, sans-serif; fill:#222; font-size:12px; font-weight:600; }
    .note { font-family: "Helvetica Neue", Arial, sans-serif; fill:#444; font-size:12px; }
  </style>

  <!-- arrow marker -->
  <defs>
    <marker id="arrowhead" viewBox="0 0 10 10" refX="9" refY="5"
            markerWidth="8" markerHeight="8" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#0b3d91"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="36" y="30" class="text" font-size="18">Two-Stage Pipeline Architecture — Floating-Point Multiplier</text>

  <!-- Stage 1 block -->
  <g transform="translate(40,60)">
    <rect class="blk" x="0" y="0" width="420" height="140"/>
    <text x="16" y="28" class="text" font-size="14">Stage-1 (Compute)</text>
    <text x="16" y="52" class="sub">Input registers: a_r, b_r, valid_r</text>

    <text x="20" y="78" class="sub">• Field Extractor (Sign, Exponent, Fraction)</text>
    <text x="20" y="100" class="sub">• Special-Case Detector (Zero, Inf, NaN)</text>
    <text x="20" y="122" class="sub">• Exponent Adder &amp; 24×24 Vedic Mantissa Multiply</text>
  </g>

  <!-- Pipeline registers -->
  <g transform="translate(490,60)">
    <rect class="reg" x="0" y="0" width="160" height="140"/>
    <text x="12" y="28" class="text" font-size="13">Pipeline Registers</text>
    <text x="12" y="54" class="sub">mant_r[22:0]</text>
    <text x="12" y="76" class="sub">expu_r[9:0]</text>
    <text x="12" y="98" class="sub">sign_r_r, flags, valid_stage1</text>
  </g>

  <!-- Stage 2 block -->
  <g transform="translate(690,60)">
    <rect class="blk" x="0" y="0" width="420" height="140"/>
    <text x="16" y="28" class="text" font-size="14">Stage-2 (Finalize)</text>
    <text x="16" y="52" class="sub">• Normalizer (shift / mantissa select)</text>
    <text x="16" y="74" class="sub">• Priority Selector (NaN &gt; Inf &gt; Zero &gt; Normal)</text>
    <text x="16" y="96" class="sub">• Output Assembler &amp; Output registers (y, valid_out)</text>
  </g>

  <!-- Data flow arrows -->
  <path class="arrow" d="M460 130 L490 130" />
  <path class="arrow" d="M650 130 L690 130" />

  <!-- Input/Output signals -->
  <g transform="translate(12,220)">
    <text x="0" y="0" class="sig">Inputs:</text>
    <text x="0" y="20" class="note">a[31:0], b[31:0], clk, rstn, valid_in</text>

    <line x1="250" y1="6" x2="450" y2="6" stroke="#c8d6f2" stroke-width="1" />
    <text x="470" y="0" class="sig">→ Stage-1</text>

    <text x="570" y="0" class="sig">→ Pipeline Registers → Stage-2</text>
    <line x1="750" y1="6" x2="950" y2="6" stroke="#c8d6f2" stroke-width="1" />
  </g>

  <g transform="translate(12,270)">
    <text x="0" y="0" class="sig">Outputs:</text>
    <text x="0" y="20" class="note">y[31:0], valid_out</text>
  </g>

  <!-- Clock / timing note -->
  <g transform="translate(36,320)">
    <rect x="0" y="0" width="1140" height="68" rx="6" fill="#fff7ed" stroke="#ffd29a" />
    <text x="12" y="22" class="note"><tspan font-weight="700">Pipeline latency:</tspan> 2 clock cycles (typical for this 2-stage design)</text>
    <text x="12" y="44" class="note">Valid_in asserted for 1 cycle → Valid_out asserted 2 cycles later. Maintain valid handshake for streaming throughput.</text>
  </g>

</svg>
